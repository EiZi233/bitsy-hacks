import { delay, evaluate, press, start, walkToCat } from './test/bitsy';

test('dialog audio vocal synth', async () => {
	await start({
		hacks: ['dialog audio vocal synth'],
	});
	await walkToCat();
	await evaluate(() => {
		window.Math.random = () => 0;
		window.log = [];
		window.setInterval(() => {
			window.log.push([
				window.hacks.dialog_audio_vocal_synth.Glottis.isTouched,
				window.hacks.dialog_audio_vocal_synth.Glottis.UITenseness,
				window.hacks.dialog_audio_vocal_synth.Tract.velumTarget,
				Object.values(window.hacks.dialog_audio_vocal_synth.Tract.targetDiameter).join(','),
				Object.values(window.hacks.dialog_audio_vocal_synth.Tract.diameter).join(','),
				window.hacks.dialog_audio_vocal_synth.Glottis.loudness,
				window.hacks.dialog_audio_vocal_synth.Glottis.vibratoAmount,
				window.hacks.dialog_audio_vocal_synth.Glottis.UIFrequency,
			]);
		}, 250);
	});
	await press('ArrowRight'); // talk to cat
	await delay(1500);
	await press('ArrowRight'); // end dialog
	await press('ArrowRight'); // talk to cat
	await press('ArrowRight'); // complete dialog
	expect(await evaluate(() => window.log)).toMatchInlineSnapshot(`
Array [
  Array [
    true,
    0.4,
    0.9,
    "0.6,0.6,0.6,0.6,0.6,0.6,0.6,1.1,1.1,1.1,1.1,1.1,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.4795454545454545,1.3772727272727272,1.275,1.1727272727272728,1.0704545454545458,0.968181818181818,0.8659090909090909,0.7636363636363637,0.6613636363636365,0.5590909090909093,0.456818181818182,0.3545454545454543,0.2522727272727272",
    "0.6,0.6,0.6,0.6,0.6,0.6,0.6,1.1,1.1,1.1,1.1,1.1,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.4795454545454545,1.3772727272727272,1.275,1.1727272727272728,1.0704545454545458,0.968181818181818,0.8659090909090909,0.7636363636363637,0.6613636363636365,0.5590909090909093,0.456818181818182,0.3545454545454543,0.2522727272727272",
    0.3,
    0.01,
    240,
  ],
  Array [
    true,
    0.4,
    0.09000000000000001,
    "0.6,0.6,0.6,0.5509090909090909,0.4895454545454545,0.4281818181818181,0.3668181818181818,0.56,0.4474999999999999,0.33499999999999996,0.22250000000000003,0.10999999999999999,0.30340909090909074,0.4568181818181818,0.6102272727272725,0.7636363636363633,0.9170454545454546,1.0704545454545453,1.2238636363636364,1.3772727272727272,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5",
    "0.6,0.6,0.6,0.5509090909090909,0.4895454545454545,0.4281818181818181,0.3668181818181818,0.56,0.4474999999999999,0.33499999999999996,0.22250000000000003,0.10999999999999999,0.30340909090909074,0.4568181818181818,0.6102272727272725,0.7636363636363633,0.9170454545454546,1.0704545454545453,1.2238636363636364,1.3772727272727272,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5",
    0.3,
    0.01,
    240,
  ],
  Array [
    false,
    0,
    0.09000000000000001,
    "0.6,0.6,0.6,0.6,0.6,0.6,0.6,1.1,1.1,1.1,1.1,1.1,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5",
    "0.6,0.6,0.6,0.6,0.6,0.6,0.6,1.1,1.1,1.1,1.1,1.1,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5",
    0.3,
    0.01,
    240,
  ],
  Array [
    false,
    0,
    0.09000000000000001,
    "0.6,0.6,0.6,0.6,0.6,0.6,0.6,1.1,1.1,1.1,1.1,1.1,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5",
    "0.6,0.6,0.6,0.6,0.6,0.6,0.6,1.1,1.1,1.1,1.1,1.1,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5",
    0.3,
    0.01,
    240,
  ],
  Array [
    false,
    0,
    0.09000000000000001,
    "0.6,0.6,0.6,0.6,0.6,0.6,0.6,1.1,1.1,1.1,1.1,1.1,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5",
    "0.6,0.6,0.6,0.6,0.6,0.6,0.6,1.1,1.1,1.1,1.1,1.1,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5",
    0.3,
    0.01,
    240,
  ],
  Array [
    false,
    0,
    0.09000000000000001,
    "0.6,0.6,0.6,0.6,0.6,0.6,0.6,1.1,1.1,1.1,1.1,1.1,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5",
    "0.6,0.6,0.6,0.6,0.6,0.6,0.6,1.1,1.1,1.1,1.1,1.1,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5",
    0.3,
    0.01,
    240,
  ],
]
`);
});
